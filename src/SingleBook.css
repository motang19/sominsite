.single-book-scene {
  --cover-width: 240px;
  --page-width: 240px;
  --book-height: 260px;
  --spine-width: 28px;
  --paper-shadow: rgba(0, 0, 0, 0.12);
  --cover-cream: #fdf8ee;
  --cover-cream-deep: #e8dbc7;
  --cover-back: #e3d3bc;
  --table: #f7f2e8;
  --spine-brown: #9b7753;
  position: relative;
  height: 100vh;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  background:
    radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.65), transparent 40%),
    radial-gradient(circle at 70% 75%, rgba(214, 191, 158, 0.2), transparent 55%),
    var(--table);
  overflow: hidden;
  perspective: 1400px;
}

.single-book-scene::before {
  content: "";
  position: absolute;
  inset: 0;
  background:
    repeating-linear-gradient(90deg, rgba(255, 255, 255, 0.06) 0px, rgba(255, 255, 255, 0.06) 1px, transparent 1px, transparent 18px),
    repeating-linear-gradient(180deg, rgba(0, 0, 0, 0.02) 0px, rgba(0, 0, 0, 0.02) 1px, transparent 1px, transparent 18px);
  mix-blend-mode: soft-light;
  opacity: 0.35;
  pointer-events: none;
}

.book {
  position: relative;
  width: calc(var(--cover-width) * 2 + var(--spine-width));
  height: var(--book-height);
  transform-style: preserve-3d;
  transition: transform 0.9s ease, box-shadow 0.9s ease;
  cursor: pointer;
}

.book::after {
  content: "";
  position: absolute;
  inset: 10px 12px 0 12px;
  background: radial-gradient(ellipse at center, rgba(0, 0, 0, 0.2), transparent 60%);
  filter: blur(14px);
  transform: translateZ(-10px);
  opacity: 0.85;
  pointer-events: none;
}

.book.stage-closed {
  transform: rotateX(0deg);
  box-shadow: 0 16px 26px rgba(0, 0, 0, 0.2);
}

.book.stage-opening {
  transform: rotateX(4deg) translateY(-4px);
  box-shadow: 0 18px 28px rgba(0, 0, 0, 0.22);
}

.book.stage-magic {
  transform: rotateX(0deg) translateY(0);
  box-shadow: 0 16px 24px rgba(0, 0, 0, 0.18);
}

.spine {
  position: absolute;
  left: calc(50% - var(--spine-width) / 2);
  top: 0;
  width: var(--spine-width);
  height: 100%;
  background: linear-gradient(90deg, #8b6745 0%, #b0845e 40%, #7b5c3c 75%);
  border-radius: 10px;
  box-shadow: inset 3px 0 6px rgba(0, 0, 0, 0.25), inset -3px 0 6px rgba(255, 255, 255, 0.1);
  transform: translateZ(2px);
  z-index: 3;
}

.cover {
  position: absolute;
  width: var(--cover-width);
  height: 100%;
  border-radius: 10px;
  backface-visibility: hidden;
  transform-style: preserve-3d;
  box-shadow: 0 10px 18px rgba(0, 0, 0, 0.16);
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: "Cormorant Garamond", "Times New Roman", serif;
  letter-spacing: 0.08em;
  color: #4a3524;
  text-transform: none;
  text-align: center;
  transition: transform 0.9s ease, opacity 0.9s ease;
  z-index: 4;
}

.cover.front {
  left: calc(50% + var(--spine-width) / 2);
  background: linear-gradient(135deg, var(--cover-cream), var(--cover-cream-deep));
  transform-origin: left center;
}

.cover.back {
  left: calc(50% - var(--spine-width) / 2 - var(--cover-width));
  background: linear-gradient(135deg, var(--cover-back), #d7c3a7);
  transform-origin: right center;
  color: transparent;
  z-index: 2;
}

.book.stage-closed .cover.front {
  transform: rotateY(0deg) translateZ(6px);
}

.book.stage-opening .cover.front,
.book.stage-magic .cover.front {
  transform: rotateY(-180deg) translateZ(6px);
  opacity: 0;
}

.book.stage-closed .cover.back {
  transform: rotateY(0deg) translateX(calc(var(--cover-width) + var(--spine-width)));
  opacity: 0;
  pointer-events: none;
}

.book.stage-opening .cover.back,
.book.stage-magic .cover.back {
  transform: rotateY(0deg);
  opacity: 1;
}

.pages {
  position: absolute;
  top: 0;
  width: var(--page-width);
  height: 100%;
  transform-style: preserve-3d;
  transition: transform 0.7s ease-out 0.2s, opacity 0.7s ease-out 0.2s;
  z-index: 3;
}

.pages.right {
  left: calc(50% + var(--spine-width) / 2);
  transform-origin: left center;
}

.pages.left {
  left: calc(50% - var(--spine-width) / 2 - var(--page-width));
  transform-origin: right center;
}

.page {
  position: absolute;
  inset: 0;
  border-radius: 8px;
  background:
    linear-gradient(180deg, #f7edd8 0%, #e9d8bc 100%),
    linear-gradient(90deg, rgba(255, 255, 255, 0.18) 0%, rgba(255, 255, 255, 0) 45%, rgba(0, 0, 0, 0.05) 100%);
  box-shadow: 0 6px 10px rgba(0, 0, 0, 0.12);
  transform-style: preserve-3d;
  backface-visibility: hidden;
  transition: transform 0.7s ease-out 0.2s, box-shadow 0.7s ease-out 0.2s, opacity 0.7s ease-out 0.2s;
  transform: translateZ(calc(var(--index) * -1.2px));
}

.pages.right .page {
  transform-origin: left center;
  z-index: calc(20 - var(--index));
}

.pages.left .page {
  transform-origin: right center;
  z-index: calc(20 - var(--index));
}

.book.stage-closed .pages.right {
  transform: rotateY(0deg);
  opacity: 0;
  pointer-events: none;
}

.book.stage-closed .pages.left {
  transform: rotateY(0deg) translateX(calc(var(--page-width) + var(--spine-width)));
  opacity: 0;
  pointer-events: none;
}

.book.stage-opening .pages.right {
  transform: rotateY(10deg);
  opacity: 1;
}

.book.stage-opening .pages.left {
  transform: rotateY(-10deg);
  opacity: 1;
}

.book.stage-opening .page {
  transform: rotateY(0deg) translateZ(calc(var(--index) * -1.2px));
}

.book.stage-magic .pages.right {
  transform: rotateY(10deg);
}

.book.stage-magic .pages.left {
  transform: rotateY(-10deg);
}

.book.stage-magic .pages.right .page {
  transform:
    rotateY(calc(3deg + var(--index) * 1.2deg))
    rotateX(calc(var(--index) * 0.3deg))
    translateZ(calc(var(--index) * -1.4px))
    translateX(calc(var(--index) * 1.1px));
  box-shadow: 0 10px 18px rgba(0, 0, 0, 0.18);
}

.book.stage-magic .pages.left .page {
  transform:
    rotateY(calc(-3deg - var(--index) * 1.2deg))
    rotateX(calc(var(--index) * 0.3deg))
    translateZ(calc(var(--index) * -1.4px))
    translateX(calc(var(--index) * -1.1px));
  box-shadow: 0 10px 18px rgba(0, 0, 0, 0.18);
}
